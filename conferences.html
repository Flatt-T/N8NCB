<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>conferenceBuddy · Conferences</title>
  <meta name="description" content="Create, view, and report on conferences using n8n Flow Endpoints (strict spec)" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    :root { --bg:#0b0d12; --card:#121623; --muted:#8a93a6; --text:#e7ecf7; --primary:#7c5cff; --primary-600:#6847ff; --ring:#2a2f3d; --border:#1c2130; --shadow:0 8px 24px rgba(0,0,0,.35); --radius:16px; }
    * { box-sizing: border-box }
    html, body { height: 100% }
    body {
      margin: 0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: radial-gradient(1200px 800px at 100% -20%, rgba(124,92,255,0.18), transparent),
                  radial-gradient(1000px 600px at -10% 0%, rgba(76,201,240,0.12), transparent),
                  var(--bg);
      color: var(--text);
    }
    a { color: #4cc9f0; text-decoration: none }
    header { position: sticky; top: 0; z-index: 5; backdrop-filter: saturate(1.2) blur(6px); background: linear-gradient(to bottom, rgba(11,13,18,0.9), rgba(11,13,18,0.6)); border-bottom: 1px solid var(--border) }
    .nav { display:flex; align-items:center; justify-content:space-between; gap:12px; padding:14px 16px; max-width:1200px; margin:0 auto }
    .brand { display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.3px }
    .brand .logo { width:28px; height:28px; border-radius:8px; background: linear-gradient(135deg, var(--primary), #4cc9f0); box-shadow: var(--shadow) }
    .nav-actions { display:flex; align-items:center; gap:8px }
    .btn, button { appearance:none; border:1px solid var(--ring); background:#0f1320; color:var(--text); padding:10px 14px; border-radius:12px; font-weight:600; cursor:pointer; transition:.2s }
    .btn:hover { border-color: var(--primary); box-shadow: 0 0 0 4px rgba(124,92,255,.12) }
    .btn.primary { background: linear-gradient(180deg, var(--primary), var(--primary-600)); border:none }
    main { max-width:1200px; margin:16px auto; padding:0 16px }
    .grid { display:grid; grid-template-columns: 1fr; gap:16px }
    @media (min-width: 980px){ .grid { grid-template-columns: 360px 1fr } }
    .card { background: linear-gradient(180deg, rgba(18,22,35,.98), rgba(18,22,35,.9)); border:1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow) }
    .section { padding:16px }
    .divider { height:1px; background: var(--border); margin:12px 0 }
    .field { display:grid; gap:6px; margin-bottom:12px }
    label { font-size:13px; color: var(--muted) }
    input, textarea { width:100%; background:#0b0f1a; color: var(--text); border:1px solid var(--ring); border-radius:12px; padding:10px 12px; outline:none; transition:.2s }
    input:focus, textarea:focus { border-color: var(--primary); box-shadow: 0 0 0 4px rgba(124,92,255,.12) }
    textarea { min-height: 72px; resize: vertical }
    .list { display:flex; flex-direction:column; gap:8px }
    .item { border:1px solid var(--ring); background:#0c101b; border-radius:12px; padding:10px; display:grid; grid-template-columns:1fr auto; align-items:center; gap:8px; cursor:pointer }
    .item:hover { border-color: var(--primary) }
    .item .title { font-weight:600 }
    .item .meta { font-size:12px; color:var(--muted) }
    .item .badge { background:#141a2a; border:1px solid var(--ring); padding:2px 8px; border-radius:999px; font-size:12px; color:var(--muted) }
    .two { display:grid; gap:12px; grid-template-columns:1fr }
    @media (min-width:720px){ .two { grid-template-columns: 1fr 1fr } }
    .tabs { display:flex; gap:6px; flex-wrap:wrap }
    .tab { border:1px solid var(--ring); padding:8px 12px; border-radius:10px; cursor:pointer; color:var(--muted) }
    .tab.active { color: var(--text); border-color: var(--primary) }
    .empty { text-align:center; color:var(--muted); padding:24px }
    #toasts { position:fixed; right:16px; bottom:16px; display:grid; gap:10px; z-index:50 }
    .toast { background:#0c101b; border:1px solid var(--ring); border-left:4px solid var(--primary); border-radius:12px; padding:12px 14px; box-shadow: var(--shadow) }
    /* Debug */
    .debug-toggle { position:fixed; right:16px; bottom:16px; z-index:85 }
    .debug-drawer { position:fixed; left:12px; right:12px; bottom:12px; z-index:90; display:none }
    .debug-drawer[open]{ display:block }
    .debug-card { background: var(--card); border:1px solid var(--border); border-radius:12px; box-shadow: var(--shadow); padding:10px }
    .debug-head { display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px }
    .debug-body { background:#0b0f1a; border:1px solid var(--ring); border-radius:10px; padding:8px; max-height:32vh; overflow:auto; font-family: ui-monospace, SFMono-Regular, Menlo, monospace; font-size:12px; line-height:1.45 }
    .logline { display:grid; grid-template-columns:120px 80px 1fr; gap:8px; padding:4px 6px; border-bottom:1px dashed #1c2130 }
    .logline:last-child { border-bottom: 0 }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, monospace }
  </style>
</head>
<body>
<header>
  <div class="nav">
    <div class="brand"><span class="logo"></span> conferenceBuddy</div>
    <div class="nav-actions">
      <button class="btn" id="refreshBtn" title="Refresh data">⟳</button>
      <a class="btn" href="index.html">Home</a>
      <a class="btn primary" href="#create">+ New</a>
    </div>
  </div>
</header>

<main class="grid">
  <!-- Left: create + list -->
  <section class="card" id="create">
    <div class="section">
      <h3>Create conference</h3>
      <p class="muted">Strict-spec: POST /conference with api_version/request_id. “Aims” maps to <code>goals_text</code>. ID is client-generated.</p>
      <form id="createForm" class="stack" autocomplete="off">
        <div class="field"><label for="cName">Name</label><input id="cName" name="name" required placeholder="DevSummit Europe 2026" /></div>
        <div class="two">
          <div class="field"><label for="cStart">Start date</label><input id="cStart" name="start_date" type="date" required /></div>
          <div class="field"><label for="cEnd">End date</label><input id="cEnd" name="end_date" type="date" required /></div>
        </div>
        <div class="two">
          <div class="field"><label for="cLocation">Location</label><input id="cLocation" name="location" placeholder="City, Country" /></div>
          <div class="field"><label for="cWebsite">Website URL</label><input id="cWebsite" name="website_url" placeholder="https://example.com" /></div>
        </div>
        <div class="field"><label for="cDesc">Description (client only)</label><textarea id="cDesc" name="description" placeholder="Short local-only note (not on API)"></textarea></div>
        <div class="field"><label for="cAims">Aims of the conference</label><textarea id="cAims" name="goals_text" placeholder="Goals / desired outcomes"></textarea></div>
        <div class="row">
          <button class="btn primary" type="submit">Create</button>
          <button class="btn" type="reset">Reset</button>
          <span class="muted">Settings live on the homepage.</span>
        </div>
      </form>
    </div>
    <div class="divider"></div>
    <div class="section">
      <div class="row" style="justify-content:space-between; align-items:center;">
        <h3 style="margin:0">Conferences</h3>
        <input id="search" placeholder="Search name/location…" style="max-width:260px; background:#0b0f1a; color:#e7ecf7; border:1px solid var(--ring); border-radius:10px; padding:8px 10px" />
      </div>
      <div class="list" id="confList" aria-live="polite"></div>
    </div>
  </section>

  <!-- Right: details -->
  <section class="card" id="details">
    <div class="section">
      <div class="row" style="justify-content:space-between; align-items:center;">
        <h3 style="margin:0">Details</h3>
        <span id="selectedMeta" class="item badge" style="border-radius:999px; padding:4px 8px; border:1px solid var(--ring); font-size:12px; color:#8a93a6">No conference selected</span>
      </div>

      <div id="emptyState" class="empty">Select a conference from the list.</div>
      <div id="detailWrap" style="display:none; display:grid; gap:12px;">
        <div class="row" style="justify-content: space-between;">
          <div>
            <div id="confTitle" style="font-weight:700; font-size:20px;"></div>
            <div id="confMeta" class="muted" style="margin-top:4px"></div>
            <div id="confAims" class="muted" style="margin-top:6px"></div>
          </div>
          <div class="row">
            <button id="eodBtn" class="btn">End-of-Day Report</button>
            <button id="eocBtn" class="btn">End-of-Conference Report</button>
          </div>
        </div>

        <div class="tabs" role="tablist">
          <button class="tab active" data-tab="overview" role="tab" aria-selected="true">Overview</button>
          <button class="tab" data-tab="vendors" role="tab">Vendors</button>
          <button class="tab" data-tab="sessions" role="tab">Sessions</button>
          <button class="tab" data-tab="reports" role="tab">Reports</button>
        </div>

        <div id="tab-overview" role="tabpanel" class="section" style="padding-top:0">
          <div class="two">
            <div class="card section">
              <strong>Key metrics</strong>
              <div class="two" style="margin-top:8px">
                <div class="item" style="cursor:default"><div><div class="title">Vendors (companies)</div><div class="meta"><span id="mVendors">–</span></div></div></div>
                <div class="item" style="cursor:default"><div><div class="title">Sessions</div><div class="meta"><span id="mSessions">–</span></div></div></div>
              </div>
            </div>
            <div class="card section">
              <strong>Sessions by day</strong>
              <canvas id="chartSessionsByDay" height="160"></canvas>
            </div>
          </div>
        </div>

        <div id="tab-vendors" role="tabpanel" class="section" hidden>
          <div class="row" style="justify-content: space-between;">
            <strong>Vendors</strong>
          </div>
          <div class="list" id="vendorList"></div>
        </div>

        <div id="tab-sessions" role="tabpane
